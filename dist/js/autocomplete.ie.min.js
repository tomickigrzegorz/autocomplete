/*!
* @name autocomplete
* @version 3.0.0
* @author Grzegorz Tomicki
* @link https://github.com/tomickigrzegorz/autocomplete
* @license MIT
*/
var Autocomplete=function(){"use strict";const t=(t,s)=>{Object.entries(s).forEach((s=>{let[i,h]=s;"addClass"===i||"removeClass"===i?e(t,"addClass"===i?"add":"remove",h):t.setAttribute(i,h)}))},s=t=>(t.firstElementChild||t).textContent.trim(),i=(t,s)=>{t.scrollTop=t.offsetTop-s.offsetHeight},h=(t,s)=>{t&&(e(t,"remove","hidden"),r(t,"click",s))},e=(t,s,i)=>t.classList[s](i),a=(s,i)=>{t(s,{"aria-activedescendant":i||""})},n=(t,s,i,h)=>{const e=h.previousSibling,a=e?e.offsetHeight:0;if("0"===t.getAttribute("aria-posinset")&&(h.scrollTop=t.offsetTop-((t,s)=>{const i=document.querySelectorAll("#"+t+" > li:not(."+s+")");return Array.from(i).reduce(((t,s)=>t+s.offsetHeight),0)})(s,i)),t.offsetTop-a<h.scrollTop)h.scrollTop=t.offsetTop-a;else{const s=t.offsetTop+t.offsetHeight-a;s>h.scrollTop+h.offsetHeight&&(h.scrollTop=s-h.offsetHeight)}},l=t=>document.createElement(t),o=t=>document.querySelector(t),r=(t,s,i)=>{t.addEventListener(s,i)},c=(t,s,i)=>{t.removeEventListener(s,i)},d=t=>({"aria-owns":t,"aria-expanded":"false","aria-autocomplete":"list",role:"combobox",removeClass:"auto-expanded"}),u=Object.freeze({ESC:27,ENTER:13,UP:38,DOWN:40,TAB:9});return class{constructor(m,p){let{delay:v=500,clearButton:b=!0,clearButtonOnInitial:f=!1,howManyCharacters:x=1,selectFirst:C=!1,insertToInput:y=!1,showValuesOnClick:k=!1,inline:O=!1,cache:j=!1,disableCloseOnSelect:g=!1,preventScrollUp:w=!1,removeResultsWhenInputIsEmpty:S=!1,regex:V={expression:/[|\\{}()[\]^$+*?]/g,replacement:"\\$&"},classGroup:I,classPreventClosing:R,classPrefix:A,ariaLabelClear:E,onSearch:T,onResults:B=(()=>{}),onSubmit:N=(()=>{}),onOpened:P=(()=>{}),onReset:$=(()=>{}),onRender:G=(()=>{}),onClose:J=(()=>{}),noResults:U=(()=>{}),onSelectedItem:W=(()=>{})}=p;var q;this.t=()=>{this.i();const s=d(this.h);var i,e,a,n,l;if(t(this.l,s),i=this.l,e=this.o,a=this.h,n=this.u,l=this.m,t(e,{id:a,role:"listbox"}),t(n,{addClass:l+"-results-wrapper"}),n.insertAdjacentElement("beforeend",e),i.parentNode.insertBefore(n,i.nextSibling),r(this.l,"input",this.p),this.v&&r(this.l,"click",this.p),this.C){const t={root:this.l,type:"load"};r(this.l,"load",this.p(t))}this.k({element:this.l,results:this.o}),this.O&&h(this.j,this.destroy)},this.S=(t,s)=>{this.V&&("update"===t?this.l.setAttribute(this.I,null==s?void 0:s.value):"remove"===t?this.l.removeAttribute(this.I):this.l.value=this.l.getAttribute(this.I))},this.p=t=>{var s;let{target:i,type:h}=t;if("true"===this.l.getAttribute("aria-expanded")&&"click"===h)return;i=this.C?this.l:i;const e=null==(s=i)?void 0:s.value.replace(this.R.expression,this.R.replacement);this.S("update",i);const a=this.v||this.C&&"load"===h?0:this.A;clearTimeout(this.T),this.T=setTimeout((()=>{var t;if(this.B&&0===(null==(t=i)?void 0:t.value.length))return void this.destroy();this.N(null==e?void 0:e.trim())}),a)},this.P=()=>{var s;e(this.u,"remove",this.$);const i=d(this.h),h=this.G?i:Object.assign({},i,{"aria-activedescendant":""});t(this.l,h),this.G||(this.J(o("."+this.U)),this.W=this.q?0:-1),(0==(null==(s=this.D)?void 0:s.length)&&!this.F||this.v)&&(this.o.textContent=""),this.L()},this.N=t=>{this.M=t,this.H(!0),h(this.j,this.destroy),t&&0!==(null==t?void 0:t.length)||!this.K||this.O||e(this.j,"add","hidden"),this.X>(null==t?void 0:t.length)&&!this.v&&!this.C?this.H():this.Y({currentValue:t,element:this.l}).then((s=>{const i=this.l.value.length,h=s.length;this.D=Array.isArray(s)?s:JSON.parse(JSON.stringify(s)),this.H(),this.Z(),0===h&&0===i&&e(this.j,"add","hidden"),0===h&&i?(e(this.l,"remove","auto-expanded"),this.P(),this._({element:this.l,currentValue:t,template:this.tt}),this.st()):(h>0||(t=>t&&"object"==typeof t&&t.constructor===Object)(s))&&(this.W=this.q?0:-1,this.tt(),this.st())})).catch((()=>{this.H(),this.P()}))},this.H=t=>this.l.parentNode.classList[t?"add":"remove"](this.it),this.Z=()=>e(this.l,"remove",this.ht),this.st=()=>{r(this.l,"keydown",this.et),r(this.l,"click",this.nt),this.C||r(document,"click",this.lt),["mousemove","click"].map((t=>{r(this.o,t,this.ot)}))},this.tt=s=>{t(this.l,{"aria-expanded":"true",addClass:this.m+"-expanded"}),this.o.textContent="";const h=0===this.D.length?this.rt({currentValue:this.M,matches:0,template:s}):this.rt({currentValue:this.M,matches:this.D,classGroup:this.ct});this.o.insertAdjacentHTML("afterbegin",h),e(this.u,"add",this.$);const a=this.ct?":not(."+this.ct+")":"";var n;this.dt=document.querySelectorAll("#"+this.h+" > li"+a),(n=this.dt).forEach(((s,i)=>{t(s,{role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":n.length,"aria-posinset":i+1})})),this.ut({type:"results",element:this.l,results:this.o}),this.vt(),i(this.o,this.u)},this.lt=t=>{let{target:s}=t,i=null;(s.closest("ul")&&this.bt||s.closest("."+this.ft))&&(i=!0),s.id===this.xt||i||this.P()},this.vt=()=>{if(this.J(o("."+this.U)),!this.q)return;const{firstElementChild:s}=this.o,i=this.ct&&this.D.length>0&&this.q?s.nextElementSibling:s;this.Ct({index:this.W,element:this.l,object:this.D[this.W],currentValue:this.l.value}),t(i,{id:this.yt+"-0",addClass:this.U,"aria-selected":"true"}),a(this.l,this.yt+"-0")},this.nt=()=>{if(this.o.textContent.length>0&&!e(this.u,"contains",this.$)){if(t(this.l,{"aria-expanded":"true",addClass:this.m+"-expanded"}),e(this.u,"add",this.$),this.G||(i(this.o,this.u),this.vt()),this.ut({type:"showItems",element:this.l,results:this.o}),!this.V)return;this.S("update",this.l)}},this.ot=t=>{t.preventDefault();const{target:s,type:i}=t,h=s.closest("li"),a=null==h?void 0:h.hasAttribute("role"),n=this.U,l=o("."+n);h&&a&&!s.closest("."+this.ft)&&("click"===i&&this.kt(h),"mousemove"!==i||e(h,"contains",n)||(this.J(l),this.Ot(h),this.W=this.jt(h),this.Ct({index:this.W,element:this.l,object:this.D[this.W]}),this.l.value.length>0&&this.K&&e(this.j,"remove","hidden")))},this.kt=t=>{t&&0!==this.D.length?(this.K&&e(this.j,"remove","hidden"),this.l.value=s(t),this.gt({index:this.W,element:this.l,object:this.D[this.W],results:this.o}),this.bt||(this.G||this.J(t),this.P()),this.S("remove")):!this.bt&&this.P()},this.jt=t=>Array.prototype.indexOf.call(this.dt,t),this.et=t=>{const{keyCode:i}=t,h=e(this.u,"contains",this.$),n=this.D.length+1;switch(this.wt=o("."+this.U),i){case u.UP:case u.DOWN:if(t.preventDefault(),n<=1&&this.q||!h)return;if(i===u.UP?(this.W<0&&(this.W=n-1),this.W-=1):(this.W+=1,this.W>=n&&(this.W=0)),this.J(this.wt),this.W>=0&&this.W<n-1){const t=this.dt[this.W];this.F&&h&&(this.l.value=s(t),this.K&&e(this.j,"remove","hidden")),this.Ct({index:this.W,element:this.l,object:this.D[this.W]}),this.Ot(t)}else this.S(),a(this.l),this.Ct({index:null,element:this.l,object:null});break;case u.ENTER:t.preventDefault(),this.kt(this.wt);break;case u.TAB:case u.ESC:t.stopPropagation(),this.C||this.P()}},this.Ot=s=>{const i=this.yt+"-"+this.jt(s);t(s,{id:i,"aria-selected":"true",addClass:this.U}),a(this.l,i),n(s,this.h,this.ct,this.o)},this.J=s=>{s&&t(s,{id:"",removeClass:this.U,"aria-selected":"false"})},this.i=()=>{this.K&&(t(this.j,{type:"button",class:this.m+"-clear hidden",title:this.St,"aria-label":this.St}),this.l.insertAdjacentElement("afterend",this.j))},this.rerender=t=>{const s=null!=t&&t.trim()?t.trim():this.l.value;null!=t&&t.trim()&&(this.l.value=t.trim(),this.S("update",this.l));const i=s.replace(this.R.expression,this.R.replacement);this.N(i.trim())},this.destroy=()=>{this.K&&e(this.j,"add","hidden"),this.l.value="",this.l.focus(),this.o.textContent="",this.C||this.P(),this.C&&this.L(),this.Z(),this.Vt(this.l),this.H(),c(this.l,"keydown",this.et),c(this.l,"click",this.nt),c(document,"click",this.lt)},this.xt=m,this.l=document.getElementById(m),this.Y=(q=T,Boolean(q&&"function"==typeof q.then)?T:t=>{let{currentValue:s,element:i}=t;return Promise.resolve(T({currentValue:s,element:i}))}),this.rt=B,this.k=G,this.gt=N,this.Ct=W,this.ut=P,this.Vt=$,this._=U,this.L=J,this.A=v,this.X=x,this.K=b,this.O=f,this.q=C,this.F=y,this.v=k,this.C=O,this.ct=I,this.ft=R,this.St=E||"clear the search query",this.m=A?A+"-auto":"auto",this.bt=g,this.G=w,this.B=S,this.V=j,this.T=null,this.h=this.m+"-"+this.xt+"-results",this.I="data-cache-auto-"+this.xt,this.it=this.m+"-is-loading",this.$=this.m+"-is-active",this.U=this.m+"-selected",this.yt=this.m+"-selected-option",this.ht=this.m+"-error",this.u=l("div"),this.o=l("ul"),this.j=l("button"),this.R=Object.assign({},{expression:/[|\\{}()[\]^$+*?]/g,replacement:"\\$&"},V),this.R.replacement||(this.R.replacement=this.It.replacement),this.R.expression||(this.R.expression=this.It.expression),this.t()}}}();
