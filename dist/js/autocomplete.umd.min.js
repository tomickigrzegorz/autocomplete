/*!
* @name autocomplete
* @version 3.0.2
* @author Grzegorz Tomicki
* @link https://github.com/tomickigrzegorz/autocomplete
* @license MIT
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Autocomplete=t()}(this,(function(){"use strict";var e=function(e,t){Object.entries(t).forEach((function(t){var i=t[0],n=t[1];"addClass"===i||"removeClass"===i?o(e,"addClass"===i?"add":"remove",n):e.setAttribute(i,n)}))},t=function(e){return(e.firstElementChild||e).textContent.trim()},i=function(e,t){e.scrollTop=e.offsetTop-t.offsetHeight},n=function(e,t){e&&(o(e,"remove","hidden"),u(e,"click",t))},o=function(e,t,i){return e.classList[t](i)},s=function(t,i){e(t,{"aria-activedescendant":i||""})},a=function(e,t,i,n){var o=n.previousSibling,s=o?o.offsetHeight:0;if("0"===e.getAttribute("aria-posinset")&&(n.scrollTop=e.offsetTop-function(e,t){var i=document.querySelectorAll("#"+e+" > li:not(."+t+")");return Array.from(i).reduce((function(e,t){return e+t.offsetHeight}),0)}(t,i)),e.offsetTop-s<n.scrollTop)n.scrollTop=e.offsetTop-s;else{var a=e.offsetTop+e.offsetHeight-s;a>n.scrollTop+n.offsetHeight&&(n.scrollTop=a-n.offsetHeight)}},d=function(e){return document.createElement(e)},r=function(e){return document.querySelector(e)},u=function(e,t,i){e.addEventListener(t,i)},c=function(e,t,i){e.removeEventListener(t,i)},l=function(e,t){return void 0===t&&(t=!1),{"aria-owns":e,"aria-expanded":"false","aria-autocomplete":t?"both":"list",role:"combobox",removeClass:"auto-expanded"}},h=Object.freeze({ESC:27,ENTER:13,UP:38,DOWN:40,TAB:9});return function(f,v){var m,p=this,b=v.delay,x=void 0===b?500:b,k=v.clearButton,y=void 0===k||k,j=v.clearButtonOnInitial,C=void 0!==j&&j,O=v.howManyCharacters,w=void 0===O?1:O,g=v.selectFirst,T=void 0!==g&&g,V=v.insertToInput,A=void 0!==V&&V,N=v.showValuesOnClick,$=void 0!==N&&N,E=v.inline,S=void 0!==E&&E,B=v.cache,J=void 0!==B&&B,P=v.disableCloseOnSelect,q=void 0!==P&&P,z=v.preventScrollUp,D=void 0!==z&&z,G=v.removeResultsWhenInputIsEmpty,I=void 0!==G&&G,R=v.regex,U=void 0===R?{expression:/[|\\{}()[\]^$+*?]/g,replacement:"\\$&"}:R,W=v.classGroup,F=v.classPreventClosing,H=v.classPrefix,K=v.ariaLabelClear,L=v.onSearch,M=v.onResults,Q=void 0===M?function(){}:M,X=v.onSubmit,Y=void 0===X?function(){}:X,Z=v.onOpened,_=void 0===Z?function(){}:Z,ee=v.onReset,te=void 0===ee?function(){}:ee,ie=v.onRender,ne=void 0===ie?function(){}:ie,oe=v.onClose,se=void 0===oe?function(){}:oe,ae=v.noResults,de=void 0===ae?function(){}:ae,re=v.onSelectedItem,ue=void 0===re?function(){}:re;this.t=function(){p.i();var t,i,o,s,a,d=l(p.o,p.u);if(e(p.l,d),t=p.l,i=p.h,o=p.o,s=p.v,a=p.m,e(i,{id:o,role:"listbox"}),e(s,{addClass:a+"-results-wrapper"}),s.insertAdjacentElement("beforeend",i),t.parentNode.insertBefore(s,t.nextSibling),u(p.l,"input",p.p),p.k&&u(p.l,"click",p.p),p.j){var r={root:p.l,type:"load"};u(p.l,"load",p.p(r))}p.C({element:p.l,results:p.h}),p.O&&n(p.T,p.destroy)},this.V=function(e,t){p.A&&("update"===e?p.l.setAttribute(p.N,null==t?void 0:t.value):"remove"===e?p.l.removeAttribute(p.N):p.l.value=p.l.getAttribute(p.N))},this.p=function(e){var t,i=e.target,n=e.type;if("true"!==p.l.getAttribute("aria-expanded")||"click"!==n){var o=null==(t=i=p.j?p.l:i)?void 0:t.value.replace(p.$.expression,p.$.replacement);p.V("update",i);var s=p.k||p.j&&"load"===n?0:p.S;clearTimeout(p.B),p.B=setTimeout((function(){var e;if(p.J&&0===(null==(e=i)?void 0:e.value.length))return void p.destroy();p.P(null==o?void 0:o.trim())}),s)}},this.q=function(){var t;o(p.v,"remove",p.D);var i=l(p.o,p.u),n=p.G?i:Object.assign({},i,{"aria-activedescendant":""});e(p.l,n),p.G||(p.I(r("."+p.R)),p.U=p.W?0:-1),(0==(null==(t=p.F)?void 0:t.length)&&!p.u||p.k)&&(p.h.textContent=""),p.H()},this.P=function(e){p.K=e,p.L(!0),n(p.T,p.destroy),e&&0!==(null==e?void 0:e.length)||!p.M||p.O||o(p.T,"add","hidden"),p.X>(null==e?void 0:e.length)&&!p.k&&!p.j?p.L():p.Y({currentValue:e,element:p.l}).then((function(t){var i=p.l.value.length,n=t.length;p.F=Array.isArray(t)?t:JSON.parse(JSON.stringify(t)),p.L(),p.Z(),0===n&&0===i&&o(p.T,"add","hidden"),0===n&&i?(o(p.l,"remove","auto-expanded"),p.q(),p._({element:p.l,currentValue:e,template:p.ee}),p.te()):(n>0||function(e){return e&&"object"==typeof e&&e.constructor===Object}(t))&&(p.U=p.W?0:-1,p.ee(),p.te())})).catch((function(){p.L(),p.q()}))},this.L=function(e){return p.l.parentNode.classList[e?"add":"remove"](p.ie)},this.Z=function(){return o(p.l,"remove",p.ne)},this.te=function(){u(p.l,"keydown",p.oe),u(p.l,"click",p.se),p.j||u(document,"click",p.ae),["mousemove","click"].map((function(e){u(p.h,e,p.de)}))},this.ee=function(t){e(p.l,{"aria-expanded":"true",addClass:p.m+"-expanded"}),p.h.textContent="";var n=0===p.F.length?p.re({currentValue:p.K,matches:0,template:t}):p.re({currentValue:p.K,matches:p.F,classGroup:p.ue});p.h.insertAdjacentHTML("afterbegin",n),o(p.v,"add",p.D);var s,a=p.ue?":not(."+p.ue+")":"";p.ce=document.querySelectorAll("#"+p.o+" > li"+a),(s=p.ce).forEach((function(t,i){e(t,{role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":s.length,"aria-posinset":i+1})})),p.le({type:"results",element:p.l,results:p.h}),p.he(),i(p.h,p.v)},this.ae=function(e){var t=e.target,i=null;(t.closest("ul")&&p.fe||t.closest("."+p.ve))&&(i=!0),t.id===p.me||i||p.q()},this.he=function(){if(p.I(r("."+p.R)),p.W){var t=p.h.firstElementChild,i=p.ue&&p.F.length>0&&p.W?t.nextElementSibling:t;p.pe({index:p.U,element:p.l,object:p.F[p.U],currentValue:p.l.value}),e(i,{id:p.be+"-0",addClass:p.R,"aria-selected":"true"}),s(p.l,p.be+"-0")}},this.se=function(){if(p.h.textContent.length>0&&!o(p.v,"contains",p.D)){if(e(p.l,{"aria-expanded":"true",addClass:p.m+"-expanded"}),o(p.v,"add",p.D),p.G||(i(p.h,p.v),p.he()),p.le({type:"showItems",element:p.l,results:p.h}),!p.A)return;p.V("update",p.l)}},this.de=function(e){e.preventDefault();var t=e.target,i=e.type,n=t.closest("li"),s=null==n?void 0:n.hasAttribute("role"),a=p.R,d=r("."+a);n&&s&&!t.closest("."+p.ve)&&("click"===i&&p.xe(n),"mousemove"!==i||o(n,"contains",a)||(p.I(d),p.ke(n),p.U=p.ye(n),p.pe({index:p.U,element:p.l,object:p.F[p.U]}),p.l.value.length>0&&p.M&&o(p.T,"remove","hidden")))},this.xe=function(e){e&&0!==p.F.length?(p.M&&o(p.T,"remove","hidden"),p.l.value=t(e),p.je({index:p.U,element:p.l,object:p.F[p.U],results:p.h}),p.fe||(p.G||p.I(e),p.q()),p.V("remove")):!p.fe&&p.q()},this.ye=function(e){return Array.prototype.indexOf.call(p.ce,e)},this.oe=function(e){var i=e.keyCode,n=o(p.v,"contains",p.D),a=p.F.length+1;switch(p.Ce=r("."+p.R),i){case h.UP:case h.DOWN:if(e.preventDefault(),a<=1&&p.W||!n)return;if(i===h.UP?(p.U<0&&(p.U=a-1),p.U-=1):(p.U+=1,p.U>=a&&(p.U=0)),p.I(p.Ce),p.U>=0&&p.U<a-1){var d=p.ce[p.U];p.u&&n&&(p.l.value=t(d),p.M&&o(p.T,"remove","hidden")),p.pe({index:p.U,element:p.l,object:p.F[p.U]}),p.ke(d)}else p.V(),s(p.l),p.pe({index:null,element:p.l,object:null});break;case h.ENTER:e.preventDefault(),p.xe(p.Ce);break;case h.TAB:case h.ESC:e.stopPropagation(),p.j||p.q()}},this.ke=function(t){var i=p.be+"-"+p.ye(t);e(t,{id:i,"aria-selected":"true",addClass:p.R}),s(p.l,i),a(t,p.o,p.ue,p.h)},this.I=function(t){t&&e(t,{id:"",removeClass:p.R,"aria-selected":"false"})},this.i=function(){p.M&&(e(p.T,{type:"button",class:p.m+"-clear hidden",title:p.Oe,"aria-label":p.Oe}),p.l.insertAdjacentElement("afterend",p.T))},this.rerender=function(e){var t=null!=e&&e.trim()?e.trim():p.l.value;null!=e&&e.trim()&&(p.l.value=e.trim(),p.V("update",p.l));var i=t.replace(p.$.expression,p.$.replacement);p.P(i.trim())},this.disable=function(t){void 0===t&&(t=!1),p.M&&o(p.T,"add","hidden"),t&&(p.l.value="",p.l.focus()),p.h.textContent="",o(p.v,"remove",p.D),e(p.l,{"aria-expanded":"false",removeClass:p.m+"-expanded","aria-activedescendant":"","aria-autocomplete":"none"}),c(p.l,"input",p.p),c(p.l,"keydown",p.oe),c(p.l,"click",p.se),p.k&&c(p.l,"click",p.p),p.j||c(document,"click",p.ae),["mousemove","click"].forEach((function(e){c(p.h,e,p.de)})),p.L(!1),p.Z(),p.H()},this.destroy=function(){p.M&&o(p.T,"add","hidden"),p.l.value="",p.l.focus(),p.h.textContent="",p.j||p.q(),p.j&&p.H(),p.Z(),p.we(p.l),p.L(),c(p.l,"keydown",p.oe),c(p.l,"click",p.se),c(document,"click",p.ae)},this.me=f,this.l=document.getElementById(f),this.Y=(m=L,Boolean(m&&"function"==typeof m.then)?L:function(e){var t=e.currentValue,i=e.element;return Promise.resolve(L({currentValue:t,element:i}))}),this.re=Q,this.C=ne,this.je=Y,this.pe=ue,this.le=_,this.we=te,this._=de,this.H=se,this.S=x,this.X=w,this.M=y,this.O=C,this.W=T,this.u=A,this.k=$,this.j=S,this.ue=W,this.ve=F,this.Oe=K||"clear the search query",this.m=H?H+"-auto":"auto",this.fe=q,this.G=D,this.J=I,this.A=J,this.B=null,this.o=this.m+"-"+this.me+"-results",this.N="data-cache-auto-"+this.me,this.ie=this.m+"-is-loading",this.D=this.m+"-is-active",this.R=this.m+"-selected",this.be=this.m+"-selected-option",this.ne=this.m+"-error",this.v=d("div"),this.h=d("ul"),this.T=d("button"),this.$=Object.assign({},{expression:/[|\\{}()[\]^$+*?]/g,replacement:"\\$&"},U),this.$.replacement||(this.$.replacement=this.ge.replacement),this.$.expression||(this.$.expression=this.ge.expression),this.t()}}));
