/*!
* @name autocomplete
* @version 3.0.4
* @author Grzegorz Tomicki
* @link https://github.com/tomickigrzegorz/autocomplete
* @license MIT
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Autocomplete=t()}(this,(function(){"use strict";var e=function(e,t){Object.entries(t).forEach((function(t){var i=t[0],n=t[1];"addClass"===i||"removeClass"===i?o(e,"addClass"===i?"add":"remove",n):e.setAttribute(i,n)}))},t=function(e){return(e.firstElementChild||e).textContent.trim()},i=function(e,t){e.scrollTop=e.offsetTop-t.offsetHeight},n=function(e,t){e&&(o(e,"remove","hidden"),u(e,"click",t))},o=function(e,t,i){return e.classList[t](i)},a=function(t,i){e(t,{"aria-activedescendant":i||""})},s=function(e,t,i,n){var o=n.previousSibling,a=o?o.offsetHeight:0;if("0"===e.getAttribute("aria-posinset")&&(n.scrollTop=e.offsetTop-function(e,t){var i=document.querySelectorAll("#"+e+" > li:not(."+t+")");return Array.from(i).reduce((function(e,t){return e+t.offsetHeight}),0)}(t,i)),e.offsetTop-a<n.scrollTop)n.scrollTop=e.offsetTop-a;else{var s=e.offsetTop+e.offsetHeight-a;s>n.scrollTop+n.offsetHeight&&(n.scrollTop=s-n.offsetHeight)}},c=function(e){return document.createElement(e)},d=function(e){return document.querySelector(e)},u=function(e,t,i){e.addEventListener(t,i)},r=function(e,t,i){e.removeEventListener(t,i)},l=function(e,t){return void 0===t&&(t=!1),{"aria-owns":e,"aria-expanded":"false","aria-autocomplete":t?"both":"list",role:"combobox",removeClass:"auto-expanded"}},h=Object.freeze({ESC:27,ENTER:13,UP:38,DOWN:40,TAB:9});return function(f,v){var m,p,b=this,k=v.delay,x=void 0===k?500:k,y=v.clearButton,w=void 0===y||y,C=v.clearButtonOnInitial,j=void 0!==C&&C,O=v.howManyCharacters,T=void 0===O?1:O,g=v.selectFirst,V=void 0!==g&&g,A=v.insertToInput,E=void 0!==A&&A,N=v.showValuesOnClick,$=void 0!==N&&N,S=v.inline,B=void 0!==S&&S,J=v.cache,P=void 0!==J&&J,q=v.disableCloseOnSelect,z=void 0!==q&&q,D=v.preventScrollUp,G=void 0!==D&&D,I=v.removeResultsWhenInputIsEmpty,R=void 0!==I&&I,U=v.regex,W=void 0===U?{expression:/[|\\{}()[\]^$+*?]/g,replacement:"\\$&"}:U,F=v.classGroup,H=v.classPreventClosing,K=v.classPrefix,L=v.ariaLabelClear,M=v.onSearch,Q=v.onResults,X=void 0===Q?function(){}:Q,Y=v.onSubmit,Z=void 0===Y?function(){}:Y,_=v.onOpened,ee=void 0===_?function(){}:_,te=v.onReset,ie=void 0===te?function(){}:te,ne=v.onRender,oe=void 0===ne?function(){}:ne,ae=v.onClose,se=void 0===ae?function(){}:ae,ce=v.noResults,de=void 0===ce?function(){}:ce,ue=v.onSelectedItem,re=void 0===ue?function(){}:ue;if(this.t=function(){b.i();var t,i,o,a,s,c=l(b.o,b.u);e(b.l,c),t=b.l,i=b.h,o=b.o,a=b.v,s=b.m,e(i,{id:o,role:"listbox"}),e(a,{addClass:s+"-results-wrapper"}),a.insertAdjacentElement("beforeend",i),t.parentNode.insertBefore(a,t.nextSibling);try{b.h.id=b.o,b.l.setAttribute("aria-controls",b.o)}catch(e){}if(u(b.l,"input",b.p),b.k&&u(b.l,"click",b.p),b.C){var d={root:b.l,type:"load"};u(b.l,"load",b.p(d))}b.j({element:b.l,results:b.h}),b.O&&n(b.T,b.destroy)},this.V=function(e,t){b.A&&("update"===e?b.l.setAttribute(b.N,null==t?void 0:t.value):"remove"===e?b.l.removeAttribute(b.N):b.l.value=b.l.getAttribute(b.N))},this.p=function(e){var t,i=e.target,n=e.type;if("true"!==b.l.getAttribute("aria-expanded")||"click"!==n){var o=null==(t=i=b.C?b.l:i)?void 0:t.value.replace(b.$.expression,b.$.replacement);b.V("update",i);var a=b.k||b.C&&"load"===n?0:b.S;clearTimeout(b.B),b.B=setTimeout((function(){var e;if(b.J&&0===(null==(e=i)?void 0:e.value.length))return void b.destroy();b.P(null==o?void 0:o.trim())}),a)}},this.q=function(){var t;o(b.v,"remove",b.D);var i=l(b.o,b.u),n=b.G?i:Object.assign({},i,{"aria-activedescendant":""});e(b.l,n),b.G||(b.I(d("."+b.R)),b.U=b.W?0:-1),(0===(null==(t=b.F)?void 0:t.length)&&!b.u||b.k)&&(b.h.textContent=""),b.H()},this.P=function(e){b.K=e,b.L(!0),n(b.T,b.destroy),e&&0!==(null==e?void 0:e.length)||!b.M||b.O||o(b.T,"add","hidden"),b.X>(null==e?void 0:e.length)&&!b.k&&!b.C?b.L():b.Y({currentValue:e,element:b.l}).then((function(t){var i=b.l.value.length,n=t.length;b.F=Array.isArray(t)?t:JSON.parse(JSON.stringify(t)),b.L(),b.Z(),0===n&&0===i&&o(b.T,"add","hidden"),0===n&&i?(o(b.l,"remove","auto-expanded"),b.q(),b._({element:b.l,currentValue:e,template:b.ee}),b.te()):(n>0||function(e){return e&&"object"==typeof e&&e.constructor===Object}(t))&&(b.U=b.W?0:-1,b.ee(),b.te())})).catch((function(){b.L(),b.q()}))},this.L=function(e){return b.l.parentNode.classList[e?"add":"remove"](b.ie)},this.Z=function(){return o(b.l,"remove",b.ne)},this.te=function(){r(b.l,"keydown",b.oe),r(b.l,"click",b.ae),r(document,"click",b.se),["mousemove","click"].forEach((function(e){r(b.h,e,b.ce)})),u(b.l,"keydown",b.oe),u(b.l,"click",b.ae),b.C||u(document,"click",b.se),["mousemove","click"].forEach((function(e){u(b.h,e,b.ce)}))},this.ee=function(t){e(b.l,{"aria-expanded":"true",addClass:b.m+"-expanded"}),b.h.textContent="";var n=0===b.F.length?b.de({currentValue:b.K,matches:0,template:t}):b.de({currentValue:b.K,matches:b.F,classGroup:b.ue});b.h.insertAdjacentHTML("afterbegin",n),o(b.v,"add",b.D);var a,s=b.ue?":not(."+b.ue+")":"";b.re=document.querySelectorAll("#"+b.o+" > li"+s),(a=b.re).forEach((function(t,i){e(t,{role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":a.length,"aria-posinset":i+1})})),b.le({type:"results",element:b.l,results:b.h}),b.he(),i(b.h,b.v)},this.se=function(e){var t=e.target,i=null;(t.closest("ul")&&b.fe||t.closest("."+b.ve))&&(i=!0),t.id===b.me||i||b.q()},this.he=function(){if(b.I(d("."+b.R)),b.W){var t=b.h.firstElementChild,i=b.ue&&b.F.length>0&&b.W?t.nextElementSibling:t;b.pe({index:b.U,element:b.l,object:b.F[b.U],currentValue:b.l.value}),e(i,{id:b.be+"-0",addClass:b.R,"aria-selected":"true"}),a(b.l,b.be+"-0")}},this.ae=function(){if(b.h.textContent.length>0&&!o(b.v,"contains",b.D)){if(e(b.l,{"aria-expanded":"true",addClass:b.m+"-expanded"}),o(b.v,"add",b.D),b.G||(i(b.h,b.v),b.he()),b.le({type:"showItems",element:b.l,results:b.h}),!b.A)return;b.V("update",b.l)}},this.ce=function(e){e.preventDefault();var i=e.target,n=e.type,a=i.closest("li"),s=null==a?void 0:a.hasAttribute("role"),c=b.R,u=d("."+c);a&&s&&!i.closest("."+b.ve)&&("click"===n&&b.ke(a),"mousemove"!==n||o(a,"contains",c)||(b.I(u),b.xe(a),b.U=b.ye(a),b.u&&(b.l.value=t(a)),b.pe({index:b.U,element:b.l,object:b.F[b.U]}),b.l.value.length>0&&b.M&&o(b.T,"remove","hidden")))},this.ke=function(e){e&&0!==b.F.length?(b.M&&o(b.T,"remove","hidden"),b.l.value=t(e),b.we({index:b.U,element:b.l,object:b.F[b.U],results:b.h}),b.fe||(b.G||b.I(e),b.q()),b.V("remove")):!b.fe&&b.q()},this.ye=function(e){return Array.prototype.indexOf.call(b.re,e)},this.oe=function(e){var i=e.keyCode,n=o(b.v,"contains",b.D),s=b.F.length+1;switch(b.Ce=d("."+b.R),i){case h.UP:case h.DOWN:if(e.preventDefault(),s<=1&&b.W||!n)return;if(i===h.UP?(b.U<0&&(b.U=s-1),b.U-=1):(b.U+=1,b.U>=s&&(b.U=0)),b.I(b.Ce),b.U>=0&&b.U<s-1){var c=b.re[b.U];b.u&&n&&(b.l.value=t(c),b.M&&o(b.T,"remove","hidden")),b.pe({index:b.U,element:b.l,object:b.F[b.U]}),b.xe(c)}else b.V(),a(b.l),b.pe({index:null,element:b.l,object:null});break;case h.ENTER:e.preventDefault(),b.ke(b.Ce);break;case h.TAB:case h.ESC:e.stopPropagation(),b.C||b.q()}},this.xe=function(t){var i=b.be+"-"+b.ye(t);e(t,{id:i,"aria-selected":"true",addClass:b.R}),a(b.l,i),s(t,b.o,b.ue,b.h)},this.I=function(t){t&&e(t,{id:"",removeClass:b.R,"aria-selected":"false"})},this.i=function(){b.M&&(e(b.T,{type:"button",class:b.m+"-clear hidden",title:b.je,"aria-label":b.je}),b.l.insertAdjacentElement("afterend",b.T))},this.rerender=function(e){var t=null!=e&&e.trim()?e.trim():b.l.value;null!=e&&e.trim()&&(b.l.value=e.trim(),b.V("update",b.l));var i=t.replace(b.$.expression,b.$.replacement);b.P(i.trim())},this.disable=function(t){void 0===t&&(t=!1),b.l.setAttribute("data-auto-disabled","true"),b.M&&o(b.T,"add","hidden"),t&&(b.l.value="",b.l.focus()),b.h.textContent="",o(b.v,"remove",b.D),e(b.l,{"aria-expanded":"false",removeClass:b.m+"-expanded","aria-activedescendant":""}),r(b.l,"input",b.p),r(b.l,"keydown",b.oe),r(b.l,"click",b.ae),b.k&&r(b.l,"click",b.p),b.C||r(document,"click",b.se),["mousemove","click"].forEach((function(e){r(b.h,e,b.ce)})),b.L(!1),b.Z(),b.H(),setTimeout((function(){b.l.setAttribute("aria-autocomplete","none")}),0)},this.enable=function(){b.l.removeAttribute("data-auto-disabled");var t=l(b.o,b.u);e(b.l,t),u(b.l,"input",b.p),u(b.l,"keydown",b.oe),u(b.l,"click",b.ae),b.k&&u(b.l,"click",b.p),b.C||u(document,"click",b.se),["mousemove","click"].forEach((function(e){u(b.h,e,b.ce)})),b.M&&b.l.value.length>0&&o(b.T,"remove","hidden"),b.le({type:"enable",element:b.l,results:b.h})},this.destroy=function(){b.M&&o(b.T,"add","hidden"),b.l.value="",b.l.focus(),b.h.textContent="",b.C||b.q(),b.C&&b.H(),b.Z(),b.Oe(b.l),b.L(),r(b.l,"keydown",b.oe),r(b.l,"click",b.ae),r(document,"click",b.se)},this.me=f,this.l=document.getElementById(f),!this.l)throw new Error('Autocomplete: Element with id "'+f+'" not found');this.Y=(p=M,Boolean(p&&"function"==typeof p.then)?M:function(e){var t=e.currentValue,i=e.element;return Promise.resolve(M({currentValue:t,element:i}))}),this.de=X,this.j=oe,this.we=Z,this.pe=re,this.le=ee,this.Oe=ie,this._=de,this.H=se,this.S=x,this.X=T,this.M=w,this.O=j,this.W=V,this.u=E,this.k=$,this.C=B,this.ue=F,this.ve=H,this.je=L||"clear the search query",this.m=K?K+"-auto":"auto",this.fe=z,this.G=G,this.J=R,this.A=P,this.B=null,this.o=this.m+"-"+this.me+"-results",this.N="data-cache-auto-"+this.me,this.ie=this.m+"-is-loading",this.D=this.m+"-is-active",this.R=this.m+"-selected",this.be=this.m+"-selected-option",this.ne=this.m+"-error",this.v=c("div"),this.h=c("ul"),this.T=c("button");var le={expression:/[|\\{}()[\]^$+*?]/g,replacement:"\\$&"};this.$={expression:W.expression||le.expression,replacement:null!=(m=W.replacement)?m:le.replacement},this.t()}}));
