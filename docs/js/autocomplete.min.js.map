{"version":3,"file":"autocomplete.min.js","sources":["../../sources/js/utils/function.js","../../sources/js/utils/keyCodes.js","../../sources/js/script.js"],"sourcesContent":["/**\r\n * Check is a Object\r\n * @param {Object} value\r\n * @returns {Boolean}\r\n */\r\nexport const isObject = (value) =>\r\n  value && typeof value === \"object\" && value.constructor === Object;\r\n\r\n/**\r\n * Check if is a Promise\r\n * https://stackoverflow.com/a/53955664/10424385\r\n *\r\n * @param {Object} value\r\n * @returns {Boolean}\r\n */\r\nexport const isPromise = (value) =>\r\n  Boolean(value && typeof value.then === \"function\");\r\n\r\n/**\r\n * Set attributes to element\r\n *\r\n * @param {HTMLElement} el\r\n * @param {Object} object\r\n */\r\nexport const setAttributes = (el, object) => {\r\n  for (let key in object) {\r\n    if (key === \"addClass\") {\r\n      classList(el, \"add\", object[key]);\r\n    } else if (key === \"removeClass\") {\r\n      classList(el, \"remove\", object[key]);\r\n    } else {\r\n      el.setAttribute(key, object[key]);\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Get first element from child\r\n *\r\n * @param {HTMLElement} element\r\n * @returns {HTMLELement}\r\n */\r\nexport const getFirstElement = (element) =>\r\n  (element.firstElementChild || element).textContent.trim();\r\n\r\n/**\r\n * Scroll to top result-list\r\n * @param {HTMLElement} resultList\r\n * @param {HTMLElement} resultWrap\r\n */\r\nexport const scrollResultsToTop = (resultList, resultWrap) => {\r\n  // if there is an overflow of ul element, after\r\n  // opening we always move ul to the top of the results\r\n  resultList.scrollTop = resultList.offsetTop - resultWrap.offsetHeight;\r\n};\r\n\r\n/**\r\n * Adding role, tabindex, aria and call handleMouse\r\n *\r\n * @param {HTMLElement} itemsLi\r\n */\r\nexport const addAriaToAllLiElements = (itemsLi) => {\r\n  // add role to all li elements\r\n  for (let i = 0; i < itemsLi.length; i++) {\r\n    setAttributes(itemsLi[i], {\r\n      role: \"option\",\r\n      tabindex: \"-1\",\r\n      \"aria-selected\": \"false\",\r\n      \"aria-setsize\": itemsLi.length,\r\n      // https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-posinset\r\n      \"aria-posinset\": i + 1,\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Show btn to clear data\r\n *\r\n * @param {HTMLElement} clearButton - button to clear data\r\n * @param {Function} destroy - destroy function\r\n */\r\nexport const showBtnToClearData = (clearButton = false, destroy) => {\r\n  if (!clearButton) return;\r\n\r\n  classList(clearButton, \"remove\", \"hidden\");\r\n  // add event to clear button\r\n  onEvent(clearButton, \"click\", destroy);\r\n};\r\n\r\n/**\r\n * ClassList add/remove/contains\r\n *\r\n * @param {HTMLElement} element - html element\r\n * @param {String} action - add/remove/contains\r\n * @param {String} className - class name\r\n */\r\nexport const classList = (element, action, className) =>\r\n  element.classList[action](className);\r\n\r\n/**\r\n * Set aria-activedescendant\r\n *\r\n * @param {HTMLElement} root - search input\r\n * @param {String} type\r\n */\r\nexport const setAriaActivedescendant = (root, type) => {\r\n  setAttributes(root, {\r\n    \"aria-activedescendant\": type || \"\",\r\n  });\r\n};\r\n\r\n/**\r\n * Get height of ul without group class\r\n *\r\n * @param {String} outputUl\r\n * @param {String} classGroup\r\n * @returns {Number}\r\n */\r\nexport const getClassGroupHeight = (outputUl, classGroup) => {\r\n  // get height of ul without group class\r\n  const allLiElements = document.querySelectorAll(\r\n    `#${outputUl} > li:not(.${classGroup})`,\r\n  );\r\n  let height = 0;\r\n  [].slice.call(allLiElements).map((el) => (height += el.offsetHeight));\r\n\r\n  // return height\r\n  return height;\r\n};\r\n\r\n/**\r\n * Scroll into view when press up/down arrows\r\n *\r\n * @param {HTMLElement} target\r\n * @param {HTMLElement} outputUl\r\n * @param {String} classGroup\r\n * @param {HTMLElement} resultList\r\n */\r\nexport const followActiveElement = (\r\n  target,\r\n  outputUl,\r\n  classGroup,\r\n  resultList,\r\n) => {\r\n  const previusElement = resultList.previousSibling;\r\n\r\n  const previusElementHeight = previusElement ? previusElement.offsetHeight : 0;\r\n\r\n  if (target.getAttribute(\"aria-posinset\") == \"0\") {\r\n    resultList.scrollTop =\r\n      target.offsetTop - getClassGroupHeight(outputUl, classGroup);\r\n  }\r\n\r\n  if (target.offsetTop - previusElementHeight < resultList.scrollTop) {\r\n    resultList.scrollTop = target.offsetTop - previusElementHeight;\r\n  } else {\r\n    const offsetBottom =\r\n      target.offsetTop + target.offsetHeight - previusElementHeight;\r\n    const scrollBottom = resultList.scrollTop + resultList.offsetHeight;\r\n    if (offsetBottom > scrollBottom) {\r\n      resultList.scrollTop = offsetBottom - resultList.offsetHeight;\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Create output-list and put after search input\r\n *\r\n * @param {HTMLElement} root - search input\r\n * @param {HTMLElement} resultList - output-list ul\r\n * @param {String} outputUl - id name of output-list\r\n * @param {HTMLElement} resultWrap - wrapper ul element\r\n * @param {String} prefix - add prefix to all class auto\r\n */\r\nexport const output = (root, resultList, outputUl, resultWrap, prefix) => {\r\n  // set attribute to results-list\r\n  setAttributes(resultList, {\r\n    id: outputUl,\r\n    tabIndex: \"0\",\r\n    role: \"listbox\",\r\n  });\r\n\r\n  // add class to wrap element\r\n  setAttributes(resultWrap, {\r\n    addClass: `${prefix}-results-wrapper`,\r\n  });\r\n\r\n  // insert the results into the wrap element\r\n  resultWrap.insertAdjacentElement(\"beforeend\", resultList);\r\n\r\n  // insert the wrap element after the search input\r\n  root.parentNode.insertBefore(resultWrap, root.nextSibling);\r\n};\r\n\r\n/**\r\n * Create element\r\n *\r\n * @param {String} type - type of element\r\n * @returns {HTMLDivElement}\r\n */\r\nexport const createElement = (type) => document.createElement(type);\r\n\r\n/**\r\n * Get element\r\n *\r\n * @param {String} element\r\n * @returns {HTMLElement}\r\n */\r\nexport const select = (element) => document.querySelector(element);\r\n\r\n/**\r\n * Event listeners\r\n *\r\n * @param {HTMLElement} element\r\n * @param {String} action\r\n * @param {Function} callback\r\n */\r\nexport const onEvent = (element, action, callback) => {\r\n  element.addEventListener(action, callback);\r\n};\r\n\r\n/**\r\n * Remove event listeners\r\n *\r\n * @param {HTMLElement} element\r\n * @param {String} action\r\n * @param {Function} callback\r\n */\r\nexport const offEvent = (element, action, callback) => {\r\n  element.removeEventListener(action, callback);\r\n};\r\n\r\n/**\r\n * Add event listeners to all elements\r\n *\r\n * @param {HTMLElement} id\r\n *\r\n */\r\nexport const ariaActiveDescendantDefault = (id) => {\r\n  return {\r\n    \"aria-owns\": id,\r\n    \"aria-expanded\": \"false\",\r\n    \"aria-autocomplete\": \"list\",\r\n    role: \"combobox\",\r\n    removeClass: \"auto-expanded\",\r\n  };\r\n};\r\n","/**\r\n * Key codes\r\n */\r\nconst keyCodes = {\r\n  ESC: 27,\r\n  ENTER: 13,\r\n  UP: 38,\r\n  DOWN: 40,\r\n  TAB: 9,\r\n};\r\n\r\nexport default keyCodes;\r\n","import {\r\n  addAriaToAllLiElements,\r\n  classList,\r\n  createElement,\r\n  followActiveElement,\r\n  getFirstElement,\r\n  isObject,\r\n  isPromise,\r\n  offEvent,\r\n  onEvent,\r\n  output,\r\n  scrollResultsToTop,\r\n  select,\r\n  setAriaActivedescendant,\r\n  setAttributes,\r\n  showBtnToClearData,\r\n  ariaActiveDescendantDefault,\r\n} from \"./utils/function\";\r\n\r\nimport keyCodes from \"./utils/keyCodes\";\r\n\r\n/**\r\n * @class Autocomplete\r\n */\r\nexport default class Autocomplete {\r\n  /**\r\n   * Constructor\r\n   *\r\n   * @param {String} element\r\n   * @param {Object} object\r\n   */\r\n  constructor(\r\n    element,\r\n    {\r\n      delay = 500,\r\n      clearButton = true,\r\n      clearButtonOnInitial = false,\r\n      howManyCharacters = 1,\r\n      selectFirst = false,\r\n      insertToInput = false,\r\n      showValuesOnClick = false,\r\n      inline = false,\r\n      cache = false,\r\n      disableCloseOnSelect = false,\r\n      preventScrollUp = false,\r\n      removeResultsWhenInputIsEmpty = false,\r\n      regex = { expression: /[|\\\\{}()[\\]^$+*?]/g, replacement: \"\\\\$&\" },\r\n      classGroup,\r\n      classPreventClosing,\r\n      classPrefix,\r\n      ariaLabelClear,\r\n      onSearch,\r\n      onResults = () => {},\r\n      onSubmit = () => {},\r\n      onOpened = () => {},\r\n      onReset = () => {},\r\n      onRender = () => {},\r\n      onClose = () => {},\r\n      noResults = () => {},\r\n      onSelectedItem = () => {},\r\n    },\r\n  ) {\r\n    this._id = element;\r\n    this._root = document.getElementById(element);\r\n    this._onSearch = isPromise(onSearch)\r\n      ? onSearch\r\n      : ({ currentValue, element }) =>\r\n          Promise.resolve(onSearch({ currentValue, element }));\r\n    this._onResults = onResults;\r\n    this._onRender = onRender;\r\n    this._onSubmit = onSubmit;\r\n    this._onSelected = onSelectedItem;\r\n    this._onOpened = onOpened;\r\n    this._onReset = onReset;\r\n    this._noResults = noResults;\r\n    this._onClose = onClose;\r\n    this._delay = delay;\r\n    this._characters = howManyCharacters;\r\n    this._clearButton = clearButton;\r\n    this._clearButtonOnInitial = clearButtonOnInitial;\r\n    this._selectFirst = selectFirst;\r\n    this._toInput = insertToInput;\r\n    this._showValuesOnClick = showValuesOnClick;\r\n    this._inline = inline;\r\n    this._classGroup = classGroup;\r\n    this._prevClosing = classPreventClosing;\r\n    this._clearBtnAriLabel = ariaLabelClear\r\n      ? ariaLabelClear\r\n      : \"clear the search query\";\r\n    this._prefix = classPrefix ? `${classPrefix}-auto` : \"auto\";\r\n    this._disable = disableCloseOnSelect;\r\n    this._preventScrollUp = preventScrollUp;\r\n    this._removeResultsWhenInputIsEmpty = removeResultsWhenInputIsEmpty;\r\n\r\n    // default config\r\n    this._cache = cache;\r\n    this._timeout = null;\r\n    this._outputUl = `${this._prefix}-${this._id}-results`;\r\n    this._cacheData = `data-cache-auto-${this._id}`;\r\n    this._isLoading = `${this._prefix}-is-loading`;\r\n    this._isActive = `${this._prefix}-is-active`;\r\n    this._activeList = `${this._prefix}-selected`;\r\n    this._selectedOption = `${this._prefix}-selected-option`;\r\n    this._err = `${this._prefix}-error`;\r\n    this._resultWrap = createElement(\"div\");\r\n    this._resultList = createElement(\"ul\");\r\n    this._clearBtn = createElement(\"button\");\r\n\r\n    // ----------------------------------------\r\n    // regex\r\n\r\n    this._regex = regex;\r\n    this._defaultExpression = {\r\n      expression: /[|\\\\{}()[\\]^$+*?]/g,\r\n      replacement: \"\\\\$&\",\r\n    };\r\n\r\n    // if regex is don't have replacement then set default\r\n    if (!this._regex.replacement) {\r\n      this._regex.replacement = this._defaultExpression.replacement;\r\n    }\r\n\r\n    // if regex is don't have expression then set default\r\n    if (!this._regex.expression) {\r\n      this._regex.expression = this._defaultExpression.expression;\r\n    }\r\n\r\n    // ----------------------------------------\r\n\r\n    this._initial();\r\n  }\r\n\r\n  /**\r\n   * Initial function\r\n   */\r\n  _initial = () => {\r\n    this._clearbutton();\r\n\r\n    const ariaAcrivedescentDefault = ariaActiveDescendantDefault(\r\n      this._outputUl,\r\n    );\r\n    setAttributes(this._root, ariaAcrivedescentDefault);\r\n\r\n    output(\r\n      this._root,\r\n      this._resultList,\r\n      this._outputUl,\r\n      this._resultWrap,\r\n      this._prefix,\r\n    );\r\n\r\n    // default aria\r\n    onEvent(this._root, \"input\", this._handleInput);\r\n\r\n    // show all values on click root input\r\n    this._showValuesOnClick && onEvent(this._root, \"click\", this._handleInput);\r\n\r\n    // show all values\r\n    if (this._inline) {\r\n      const config = { root: this._root, type: \"load\" };\r\n      onEvent(this._root, \"load\", this._handleInput(config));\r\n    }\r\n\r\n    // calback functions\r\n    this._onRender({\r\n      element: this._root,\r\n      results: this._resultList,\r\n    });\r\n\r\n    // show clear button if\r\n    if (this._clearButtonOnInitial) {\r\n      showBtnToClearData(this._clearBtn, this.destroy);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Actions on input\r\n   *\r\n   * @param {String} type - set attribute depending on type\r\n   * @param {String} target\r\n   */\r\n  _cacheAct = (type, target) => {\r\n    if (!this._cache) return;\r\n\r\n    if (type === \"update\") {\r\n      this._root.setAttribute(this._cacheData, target?.value);\r\n    } else if (type === \"remove\") {\r\n      this._root.removeAttribute(this._cacheData);\r\n    } else {\r\n      this._root.value = this._root.getAttribute(this._cacheData);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handle input\r\n   *\r\n   * @param {Event} object\r\n   */\r\n  _handleInput = ({ target, type }) => {\r\n    if (\r\n      this._root.getAttribute(\"aria-expanded\") === \"true\" &&\r\n      type === \"click\"\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    // if inline is true then set root to target\r\n    target = this._inline ? this._root : target;\r\n    // replace all special characters\r\n    const regex = target?.value.replace(\r\n      this._regex.expression,\r\n      this._regex.replacement,\r\n    );\r\n\r\n    // update data attribute cache\r\n    this._cacheAct(\"update\", target);\r\n\r\n    const delay =\r\n      this._showValuesOnClick || (this._inline && type === \"load\")\r\n        ? 0\r\n        : this._delay;\r\n\r\n    clearTimeout(this._timeout);\r\n    this._timeout = setTimeout(() => {\r\n      // removeResultsWhenInputIsEmpty\r\n      // remove results when input is empty\r\n      if (this._removeResultsWhenInputIsEmpty) {\r\n        if (target?.value.length === 0) {\r\n          this.destroy();\r\n          return;\r\n        }\r\n      }\r\n\r\n      this._searchItem(regex?.trim());\r\n    }, delay);\r\n  };\r\n\r\n  /**\r\n   * Default aria\r\n   */\r\n  _reset = () => {\r\n    // remove class isActive\r\n    classList(this._resultWrap, \"remove\", this._isActive);\r\n\r\n    const ariaAcrivedescentDefault = ariaActiveDescendantDefault(\r\n      this._outputUl,\r\n    );\r\n\r\n    const ariaAcrivedescent = this._preventScrollUp\r\n      ? ariaAcrivedescentDefault\r\n      : { ...ariaAcrivedescentDefault, \"aria-activedescendant\": \"\" };\r\n\r\n    // set attributes to root - input\r\n    setAttributes(this._root, ariaAcrivedescent);\r\n\r\n    if (!this._preventScrollUp) {\r\n      // set default aria-selected, remove id and remove class 'auto-selected'\r\n      this._removeAria(select(`.${this._activeList}`));\r\n\r\n      // set index\r\n      this._index = this._selectFirst ? 0 : -1;\r\n    }\r\n\r\n    // remove result when lengh = 0 and insertToInput is false\r\n    // https://github.com/tomickigrzegorz/autocomplete/issues/136\r\n    if (\r\n      (this._matches?.length == 0 && !this._toInput) ||\r\n      this._showValuesOnClick\r\n    ) {\r\n      this._resultList.textContent = \"\";\r\n    }\r\n\r\n    // callback function\r\n    this._onClose();\r\n  };\r\n\r\n  /**\r\n   * The async function gets the text from the search\r\n   * and returns the matching array\r\n   *\r\n   * @param {String} value\r\n   */\r\n  _searchItem = (value) => {\r\n    this._value = value;\r\n\r\n    // if searching show loading icon\r\n    this._onLoading(true);\r\n\r\n    // hide button clear\r\n    showBtnToClearData(this._clearBtn, this.destroy);\r\n\r\n    // if there is no value and clearButton is true\r\n    if (\r\n      (!value || value?.length === 0) &&\r\n      this._clearButton &&\r\n      !this._clearButtonOnInitial\r\n    ) {\r\n      classList(this._clearBtn, \"add\", \"hidden\");\r\n    }\r\n\r\n    // if declare characters more then value.len and showAll is false\r\n    // remove class isActive\r\n    if (\r\n      this._characters > value?.length &&\r\n      !this._showValuesOnClick &&\r\n      !this._inline\r\n    ) {\r\n      this._onLoading();\r\n      return;\r\n    }\r\n\r\n    // callblack function onSearch\r\n    this._onSearch({ currentValue: value, element: this._root })\r\n      .then((result) => {\r\n        const rootValueLength = this._root.value.length;\r\n        const resultLength = result.length;\r\n        // set no result\r\n        this._matches = Array.isArray(result)\r\n          ? result\r\n          : JSON.parse(JSON.stringify(result));\r\n\r\n        this._onLoading();\r\n        this._error();\r\n\r\n        // if use destroy() method\r\n        if (resultLength === 0 && rootValueLength === 0) {\r\n          classList(this._clearBtn, \"add\", \"hidden\");\r\n        }\r\n\r\n        if (resultLength === 0 && rootValueLength) {\r\n          classList(this._root, \"remove\", \"auto-expanded\");\r\n          this._reset();\r\n          this._noResults({\r\n            element: this._root,\r\n            currentValue: value,\r\n            template: this._results,\r\n          });\r\n          this._events();\r\n        } else if (resultLength > 0 || isObject(result)) {\r\n          this._index = this._selectFirst ? 0 : -1;\r\n          this._results();\r\n          this._events();\r\n        }\r\n      })\r\n      .catch(() => {\r\n        this._onLoading();\r\n        this._reset();\r\n      });\r\n  };\r\n\r\n  /**\r\n   * Set or remove loading class\r\n   *\r\n   * @param {Boolean} type\r\n   */\r\n  _onLoading = (type) =>\r\n    this._root.parentNode.classList[type ? \"add\" : \"remove\"](this._isLoading);\r\n\r\n  /**\r\n   * Set error class to the root element\r\n   */\r\n  _error = () => classList(this._root, \"remove\", this._err);\r\n\r\n  /**\r\n   * Events\r\n   */\r\n  _events = () => {\r\n    // handle click on keydown [up, down, enter, tab, esc]\r\n    onEvent(this._root, \"keydown\", this._handleKeys);\r\n\r\n    onEvent(this._root, \"click\", this._handleShowItems);\r\n\r\n    // close expanded items\r\n    if (!this._inline) {\r\n      onEvent(document, \"click\", this._handleDocClick);\r\n    }\r\n\r\n    // temporarily disabled mouseleave\r\n    [\"mousemove\", \"click\"].map((eventType) => {\r\n      onEvent(this._resultList, eventType, this._handleMouse);\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Results\r\n   *\r\n   * @param {HTMLElement|String} template - html or string returned from the function,\r\n   * look at the example - https://github.com/tomickigrzegorz/autocomplete/blob/master/docs/js/examples/no-results.js#L30\r\n   */\r\n  _results = (template) => {\r\n    // set attribute to root\r\n    setAttributes(this._root, {\r\n      \"aria-expanded\": \"true\",\r\n      addClass: `${this._prefix}-expanded`,\r\n    });\r\n\r\n    // clear result list\r\n    this._resultList.textContent = \"\";\r\n\r\n    // add all found records to otput ul\r\n    const dataResults =\r\n      this._matches.length === 0\r\n        ? this._onResults({\r\n            currentValue: this._value,\r\n            matches: 0,\r\n            template,\r\n          })\r\n        : this._onResults({\r\n            currentValue: this._value,\r\n            matches: this._matches,\r\n            classGroup: this._classGroup,\r\n          });\r\n\r\n    // add data to ul\r\n    this._resultList.insertAdjacentHTML(\"afterbegin\", dataResults);\r\n\r\n    // add class isActive\r\n    classList(this._resultWrap, \"add\", this._isActive);\r\n\r\n    const checkIfClassGroupExist = this._classGroup\r\n      ? `:not(.${this._classGroup})`\r\n      : \"\";\r\n\r\n    this._itemsLi = document.querySelectorAll(\r\n      `#${this._outputUl} > li${checkIfClassGroupExist}`,\r\n    );\r\n\r\n    // adding role, tabindex and aria\r\n    addAriaToAllLiElements(this._itemsLi);\r\n\r\n    // action on open results\r\n    this._onOpened({\r\n      type: \"results\",\r\n      element: this._root,\r\n      results: this._resultList,\r\n    });\r\n\r\n    // select first element\r\n    this._selectFirstElement();\r\n\r\n    // move the view item to the first item\r\n    // this.resultList.scrollTop = 0;\r\n    // if (this._preventScrollUp) return;\r\n    scrollResultsToTop(this._resultList, this._resultWrap);\r\n  };\r\n\r\n  /**\r\n   * Hangle click on document\r\n   *\r\n   * @param {Event} object\r\n   */\r\n  _handleDocClick = ({ target }) => {\r\n    let disableClose = null;\r\n\r\n    // if 'target' is a ul and 'disableCloseOnSelect'\r\n    // is a 'true' set 'disableClose' on true\r\n    if (\r\n      (target.closest(\"ul\") && this._disable) ||\r\n      // when class classDisableClose\r\n      // then do not not close results\r\n      target.closest(`.${this._prevClosing}`)\r\n    ) {\r\n      disableClose = true;\r\n    }\r\n\r\n    if (target.id !== this._id && !disableClose) {\r\n      this._reset();\r\n      return;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Select first element\r\n   */\r\n  _selectFirstElement = () => {\r\n    this._removeAria(select(`.${this._activeList}`));\r\n\r\n    if (!this._selectFirst) {\r\n      return;\r\n    }\r\n\r\n    const { firstElementChild } = this._resultList;\r\n\r\n    const classSelectFirst =\r\n      this._classGroup && this._matches.length > 0 && this._selectFirst\r\n        ? firstElementChild.nextElementSibling\r\n        : firstElementChild;\r\n\r\n    // calback function onSelect when first element is true\r\n\r\n    this._onSelected({\r\n      index: this._index,\r\n      element: this._root,\r\n      object: this._matches[this._index],\r\n      currentValue: this._root.value,\r\n    });\r\n\r\n    // set attribute to first element\r\n    setAttributes(classSelectFirst, {\r\n      id: `${this._selectedOption}-0`,\r\n      addClass: this._activeList,\r\n      \"aria-selected\": \"true\",\r\n    });\r\n\r\n    // set aria active descendant\r\n    setAriaActivedescendant(this._root, `${this._selectedOption}-0`);\r\n  };\r\n\r\n  /**\r\n   * show items when items.length > 0 and is not empty\r\n   */\r\n  _handleShowItems = () => {\r\n    // if resultWrap is not active and resultList is not empty\r\n    if (\r\n      this._resultList.textContent.length > 0 &&\r\n      !classList(this._resultWrap, \"contains\", this._isActive)\r\n    ) {\r\n      // set attribute to root\r\n      setAttributes(this._root, {\r\n        \"aria-expanded\": \"true\",\r\n        addClass: `${this._prefix}-expanded`,\r\n      });\r\n\r\n      // add isActive class to resultWrap\r\n      classList(this._resultWrap, \"add\", this._isActive);\r\n\r\n      // move the view item to the first item\r\n      // this.resultList.scrollTop = 0;\r\n      if (!this._preventScrollUp) {\r\n        scrollResultsToTop(this._resultList, this._resultWrap);\r\n        // select first element\r\n        this._selectFirstElement();\r\n      }\r\n\r\n      // callback function\r\n      this._onOpened({\r\n        type: \"showItems\",\r\n        element: this._root,\r\n        results: this._resultList,\r\n      });\r\n\r\n      if (!this._cache) return;\r\n      this._cacheAct(\"update\", this._root);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Adding text from the list when li is clicking\r\n   * or adding aria-selected to li elements\r\n   *\r\n   * @param {Event} event\r\n   */\r\n  _handleMouse = (event) => {\r\n    event.preventDefault();\r\n\r\n    const { target, type } = event;\r\n    const targetClosest = target.closest(\"li\");\r\n    const targetClosestRole = targetClosest?.hasAttribute(\"role\");\r\n    const activeClass = this._activeList;\r\n    const activeClassElement = select(`.${activeClass}`);\r\n\r\n    if (\r\n      !targetClosest ||\r\n      !targetClosestRole ||\r\n      target.closest(`.${this._prevClosing}`)\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if (type === \"click\") {\r\n      // click on li get element\r\n      // get text from clicked li\r\n      this._getTextFromLi(targetClosest);\r\n    }\r\n\r\n    if (\r\n      type === \"mousemove\" &&\r\n      !classList(targetClosest, \"contains\", activeClass)\r\n    ) {\r\n      this._removeAria(activeClassElement);\r\n\r\n      // add aria to li\r\n      this._setAria(targetClosest);\r\n      this._index = this._indexLiSelected(targetClosest);\r\n\r\n      this._onSelected({\r\n        index: this._index,\r\n        element: this._root,\r\n        object: this._matches[this._index],\r\n      });\r\n\r\n      if (this._root.value.length > 0) {\r\n        this._clearButton && classList(this._clearBtn, \"remove\", \"hidden\");\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Get text from li on enter or click\r\n   *\r\n   * @param {HTMLElement} element\r\n   */\r\n  _getTextFromLi = (element) => {\r\n    if (!element || this._matches.length === 0) {\r\n      // set default settings\r\n      !this._disable && this._reset();\r\n\r\n      return;\r\n    }\r\n\r\n    // show clearBtn when select element\r\n    this._clearButton && classList(this._clearBtn, \"remove\", \"hidden\");\r\n\r\n    // get first element from li and set it to root\r\n    this._root.value = getFirstElement(element);\r\n\r\n    // onSubmit passing text to function\r\n    this._onSubmit({\r\n      index: this._index,\r\n      element: this._root,\r\n      object: this._matches[this._index],\r\n      results: this._resultList,\r\n    });\r\n\r\n    // set default settings\r\n    if (!this._disable) {\r\n      if (!this._preventScrollUp) {\r\n        this._removeAria(element);\r\n      }\r\n      this._reset();\r\n    }\r\n\r\n    // remove cache\r\n    this._cacheAct(\"remove\");\r\n  };\r\n\r\n  /**\r\n   * Return which li element was selected\r\n   * by hovering the mouse over\r\n   *\r\n   * @param {HTMLElement} target\r\n   * @returns {Number}\r\n   */\r\n  _indexLiSelected = (target) =>\r\n    // get index of li element\r\n    Array.prototype.indexOf.call(this._itemsLi, target);\r\n\r\n  /**\r\n   * Navigating the elements li and enter\r\n   *\r\n   * @param {Event} event\r\n   */\r\n  _handleKeys = (event) => {\r\n    const { keyCode } = event;\r\n\r\n    const resultList = classList(this._resultWrap, \"contains\", this._isActive);\r\n\r\n    const matchesLength = this._matches.length + 1;\r\n    this._selectedLi = select(`.${this._activeList}`);\r\n\r\n    // switch between keys\r\n    switch (keyCode) {\r\n      case keyCodes.UP:\r\n      case keyCodes.DOWN:\r\n        // Wrong cursor position in the input field #62\r\n        // Prevents the cursor from moving to the beginning\r\n        // of input as the cursor hovers over the results.\r\n        event.preventDefault();\r\n\r\n        if ((matchesLength <= 1 && this._selectFirst) || !resultList) {\r\n          return;\r\n        }\r\n\r\n        // if keyCode is up\r\n        if (keyCode === keyCodes.UP) {\r\n          if (this._index < 0) {\r\n            this._index = matchesLength - 1;\r\n          }\r\n          this._index -= 1;\r\n        } else {\r\n          this._index += 1;\r\n          if (this._index >= matchesLength) {\r\n            this._index = 0;\r\n          }\r\n        }\r\n\r\n        // remove aria-selected\r\n        this._removeAria(this._selectedLi);\r\n\r\n        if (this._index >= 0 && this._index < matchesLength - 1) {\r\n          const selectedElement = this._itemsLi[this._index];\r\n\r\n          if (this._toInput && resultList) {\r\n            this._root.value = getFirstElement(selectedElement);\r\n\r\n            this._clearButton && classList(this._clearBtn, \"remove\", \"hidden\");\r\n          }\r\n\r\n          // callback function\r\n          this._onSelected({\r\n            index: this._index,\r\n            element: this._root,\r\n            object: this._matches[this._index],\r\n          });\r\n\r\n          // set aria-selected\r\n          this._setAria(selectedElement);\r\n        } else {\r\n          // catch action\r\n          this._cacheAct();\r\n          setAriaActivedescendant(this._root);\r\n\r\n          this._onSelected({\r\n            index: null,\r\n            element: this._root,\r\n            object: null,\r\n          });\r\n        }\r\n\r\n        break;\r\n      // keycode enter\r\n      case keyCodes.ENTER:\r\n        // https:github.com/tomickigrzegorz/autocomplete/issues/145\r\n        event.preventDefault();\r\n\r\n        this._getTextFromLi(this._selectedLi);\r\n        break;\r\n\r\n      // keycode escape and keycode tab\r\n      case keyCodes.TAB:\r\n      case keyCodes.ESC:\r\n        event.stopPropagation();\r\n        if (!this._inline) {\r\n          this._reset();\r\n        }\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Set aria label on item li\r\n   *\r\n   * @param {HTMLElement} target\r\n   */\r\n  _setAria = (target) => {\r\n    const selectedOption = `${this._selectedOption}-${this._indexLiSelected(\r\n      target,\r\n    )}`;\r\n\r\n    // set aria to li\r\n    setAttributes(target, {\r\n      id: selectedOption,\r\n      \"aria-selected\": \"true\",\r\n      addClass: this._activeList,\r\n    });\r\n\r\n    setAriaActivedescendant(this._root, selectedOption);\r\n\r\n    // scrollIntoView when press up/down arrows\r\n    followActiveElement(\r\n      target,\r\n      this._outputUl,\r\n      this._classGroup,\r\n      this._resultList,\r\n    );\r\n  };\r\n\r\n  /**\r\n   * Remove aria label from item li\r\n   *\r\n   * @param {HTMLElement} element\r\n   */\r\n  _removeAria = (element) => {\r\n    if (!element) return;\r\n\r\n    // remove aria from li\r\n    setAttributes(element, {\r\n      id: \"\",\r\n      removeClass: this._activeList,\r\n      \"aria-selected\": \"false\",\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Create clear button and\r\n   * removing text from the input field\r\n   */\r\n  _clearbutton = () => {\r\n    // stop when clear button is disabled\r\n    if (!this._clearButton) return;\r\n\r\n    // add aria to clear button\r\n    setAttributes(this._clearBtn, {\r\n      class: `${this._prefix}-clear hidden`,\r\n      title: this._clearBtnAriLabel,\r\n      \"aria-label\": this._clearBtnAriLabel,\r\n    });\r\n\r\n    // insert clear button after input - root\r\n    this._root.insertAdjacentElement(\"afterend\", this._clearBtn);\r\n  };\r\n\r\n  /**\r\n   * Rerender rows without remove root input and close elements\r\n   * @param {String} inputValue\r\n   */\r\n  rerender = (inputValue) => {\r\n    const text = inputValue?.trim() ? inputValue.trim() : this._root.value;\r\n    if (inputValue?.trim()) {\r\n      this._root.value = inputValue.trim();\r\n      this._cacheAct(\"update\", this._root);\r\n    }\r\n    const regexText = text.replace(\r\n      this._regex.expression,\r\n      this._regex.replacement,\r\n    );\r\n    this._searchItem(regexText.trim());\r\n  };\r\n\r\n  /**\r\n   * Clicking on the clear button\r\n   * publick destroy method\r\n   */\r\n  destroy = () => {\r\n    // if clear button is true then add class hidden\r\n    this._clearButton && classList(this._clearBtn, \"add\", \"hidden\");\r\n    // clear value searchId\r\n    this._root.value = \"\";\r\n    // set focus\r\n    this._root.focus();\r\n    // remove li from ul\r\n    this._resultList.textContent = \"\";\r\n    // if inline: true don't reset\r\n    if (!this._inline) this._reset();\r\n    // if inline: true keep onClose method\r\n    if (this._inline) this._onClose();\r\n    // remove error if exist\r\n    this._error();\r\n    // callback function\r\n    this._onReset(this._root);\r\n    // remove animation on loading\r\n    this._onLoading();\r\n\r\n    // remove listener\r\n    offEvent(this._root, \"keydown\", this._handleKeys);\r\n    offEvent(this._root, \"click\", this._handleShowItems);\r\n    // remove listener on click on document\r\n    offEvent(document, \"click\", this._handleDocClick);\r\n  };\r\n}\r\n"],"names":["setAttributes","el","object","key","classList","setAttribute","getFirstElement","element","firstElementChild","textContent","trim","scrollResultsToTop","resultList","resultWrap","scrollTop","offsetTop","offsetHeight","showBtnToClearData","clearButton","destroy","onEvent","action","className","setAriaActivedescendant","root","type","followActiveElement","target","outputUl","classGroup","previusElement","previousSibling","previusElementHeight","getAttribute","getClassGroupHeight","allLiElements","document","querySelectorAll","height","slice","call","map","offsetBottom","createElement","select","querySelector","callback","addEventListener","offEvent","removeEventListener","ariaActiveDescendantDefault","id","role","removeClass","keyCodes","constructor","_ref","delay","clearButtonOnInitial","howManyCharacters","selectFirst","insertToInput","showValuesOnClick","inline","cache","disableCloseOnSelect","preventScrollUp","removeResultsWhenInputIsEmpty","regex","expression","replacement","classPreventClosing","classPrefix","ariaLabelClear","onSearch","onResults","onSubmit","onOpened","onReset","onRender","onClose","noResults","onSelectedItem","value","this","_initial","_clearbutton","ariaAcrivedescentDefault","_outputUl","output","prefix","_root","_resultList","_resultWrap","_prefix","tabIndex","addClass","insertAdjacentElement","parentNode","insertBefore","nextSibling","_handleInput","_showValuesOnClick","_inline","config","_onRender","results","_clearButtonOnInitial","_clearBtn","_cacheAct","_cache","_cacheData","removeAttribute","_ref2","replace","_regex","_delay","clearTimeout","_timeout","setTimeout","_removeResultsWhenInputIsEmpty","length","_searchItem","_reset","_isActive","ariaAcrivedescent","_preventScrollUp","_removeAria","_activeList","_index","_selectFirst","_matches","_toInput","_onClose","_value","_onLoading","_clearButton","_characters","_onSearch","currentValue","then","result","rootValueLength","resultLength","Array","isArray","JSON","parse","stringify","_error","_noResults","template","_results","_events","Object","isObject","catch","_isLoading","_err","_handleKeys","_handleShowItems","_handleDocClick","eventType","_handleMouse","dataResults","_onResults","matches","_classGroup","insertAdjacentHTML","checkIfClassGroupExist","_itemsLi","itemsLi","i","tabindex","addAriaToAllLiElements","_onOpened","_selectFirstElement","_ref3","disableClose","closest","_disable","_prevClosing","_id","classSelectFirst","nextElementSibling","_onSelected","index","_selectedOption","event","preventDefault","targetClosest","targetClosestRole","hasAttribute","activeClass","activeClassElement","_getTextFromLi","_setAria","_indexLiSelected","_onSubmit","prototype","indexOf","keyCode","matchesLength","_selectedLi","selectedElement","stopPropagation","selectedOption","class","title","_clearBtnAriLabel","rerender","inputValue","text","regexText","focus","_onReset","getElementById","Boolean","_ref4","Promise","resolve","_defaultExpression"],"mappings":"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"}